{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\MihaiPopa\\\\WebstormProjects\\\\video-player-application\\\\src\\\\components\\\\VideoPlayer.js\";\nimport React, { useRef, useEffect, useCallback, useState } from 'react';\nimport Hls from 'hls.js';\nimport ProgressBar from './ProgressBar';\nimport SkipButtons from './SkipButtons';\nconst VideoPlayer = () => {\n  const videoRef = useRef(null);\n  const playerRef = useRef(null);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const onError = useCallback(error => {\n    console.error('Error code', error.code, 'object', error);\n  }, []);\n  const onErrorEvent = useCallback(event => {\n    onError(event.detail);\n  }, [onError]);\n  const onLevelSwitching = useCallback((event, data) => {\n    console.log('HLS level switched:', data.level);\n    const hls = playerRef.current;\n    if (hls && data && data.details && data.details.live === false) {\n      const newLevel = data.level;\n      const levels = hls.levels || [];\n      const currentLevel = levels.findIndex(level => level.url === hls.url);\n      if (currentLevel !== -1 && newLevel > currentLevel) {\n        hls.nextLevel = newLevel;\n      }\n    }\n  }, []);\n  useEffect(() => {\n    const initializePlayer = async () => {\n      const video = videoRef.current;\n      const hls = new Hls();\n      playerRef.current = hls;\n\n      // Attach error event listener\n      hls.on(Hls.Events.ERROR, (event, data) => {\n        onError(data);\n      });\n\n      // Attach adaptive bitstream changes\n      hls.on(Hls.Events.LEVEL_SWITCHING, onLevelSwitching);\n      const manifestUrl = 'https://d3ukqbhrqb4xnt.cloudfront.net/share_videos/6e95f9a732a74664a4982adf4b808500/e8ffab99-e494-495d-8b21-787e95f9672d/211115200114.m3u8';\n      try {\n        hls.loadSource(manifestUrl);\n        hls.attachMedia(video);\n        hls.on(Hls.Events.MANIFEST_PARSED, () => {\n          console.log('HLS manifest parsed');\n          setIsLoading(false);\n          setIsPlaying(true);\n          video.play(); // Autoplay the video\n        });\n      } catch (error) {\n        onError(error);\n      }\n    };\n    initializePlayer();\n    return () => {\n      const hls = playerRef.current;\n      if (hls) {\n        hls.destroy();\n      }\n    };\n  }, [onError, onErrorEvent, onLevelSwitching]);\n  const handleVideoPlay = useCallback(() => {\n    setIsPlaying(true);\n    videoRef.current.play();\n  }, []);\n  const handleVideoPause = useCallback(() => {\n    setIsPlaying(false);\n    videoRef.current.pause();\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"video-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"video\", {\n    className: \"hls-video\",\n    ref: videoRef,\n    onClick: isPlaying ? handleVideoPause : handleVideoPlay,\n    muted: isPlaying,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 4\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"controls-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 4\n    }\n  }, isLoading ? /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 6\n    }\n  }, \"Loading...\") : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ProgressBar, {\n    videoRef: videoRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(SkipButtons, {\n    videoRef: videoRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }\n  }))));\n};\nexport default VideoPlayer;","map":{"version":3,"names":["React","useRef","useEffect","useCallback","useState","Hls","ProgressBar","SkipButtons","VideoPlayer","videoRef","playerRef","isPlaying","setIsPlaying","isLoading","setIsLoading","onError","error","console","code","onErrorEvent","event","detail","onLevelSwitching","data","log","level","hls","current","details","live","newLevel","levels","currentLevel","findIndex","url","nextLevel","initializePlayer","video","on","Events","ERROR","LEVEL_SWITCHING","manifestUrl","loadSource","attachMedia","MANIFEST_PARSED","play","destroy","handleVideoPlay","handleVideoPause","pause","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","ref","onClick","muted","Fragment"],"sources":["C:/Users/MihaiPopa/WebstormProjects/video-player-application/src/components/VideoPlayer.js"],"sourcesContent":["import React, { useRef, useEffect, useCallback, useState } from 'react';\nimport Hls from 'hls.js';\nimport ProgressBar from './ProgressBar';\nimport SkipButtons from './SkipButtons';\n\nconst VideoPlayer = () => {\n\tconst videoRef = useRef(null);\n\tconst playerRef = useRef(null);\n\tconst [isPlaying, setIsPlaying] = useState(false);\n\tconst [isLoading, setIsLoading] = useState(true);\n\n\tconst onError = useCallback((error) => {\n\t\tconsole.error('Error code', error.code, 'object', error);\n\t}, []);\n\n\tconst onErrorEvent = useCallback((event) => {\n\t\tonError(event.detail);\n\t}, [onError]);\n\n\tconst onLevelSwitching = useCallback((event, data) => {\n\t\tconsole.log('HLS level switched:', data.level);\n\t\tconst hls = playerRef.current;\n\t\tif (hls && data && data.details && data.details.live === false) {\n\t\t\tconst newLevel = data.level;\n\t\t\tconst levels = hls.levels || [];\n\t\t\tconst currentLevel = levels.findIndex((level) => level.url === hls.url);\n\t\t\tif (currentLevel !== -1 && newLevel > currentLevel) {\n\t\t\t\thls.nextLevel = newLevel;\n\t\t\t}\n\t\t}\n\t}, []);\n\n\tuseEffect(() => {\n\t\tconst initializePlayer = async () => {\n\t\t\tconst video = videoRef.current;\n\t\t\tconst hls = new Hls();\n\t\t\tplayerRef.current = hls;\n\n\t\t\t// Attach error event listener\n\t\t\thls.on(Hls.Events.ERROR, (event, data) => {\n\t\t\t\tonError(data);\n\t\t\t});\n\n\t\t\t// Attach adaptive bitstream changes\n\t\t\thls.on(Hls.Events.LEVEL_SWITCHING, onLevelSwitching);\n\n\t\t\tconst manifestUrl =\n\t\t\t\t'https://d3ukqbhrqb4xnt.cloudfront.net/share_videos/6e95f9a732a74664a4982adf4b808500/e8ffab99-e494-495d-8b21-787e95f9672d/211115200114.m3u8';\n\n\t\t\ttry {\n\t\t\t\thls.loadSource(manifestUrl);\n\t\t\t\thls.attachMedia(video);\n\n\t\t\t\thls.on(Hls.Events.MANIFEST_PARSED, () => {\n\t\t\t\t\tconsole.log('HLS manifest parsed');\n\t\t\t\t\tsetIsLoading(false);\n\t\t\t\t\tsetIsPlaying(true);\n\t\t\t\t\tvideo.play(); // Autoplay the video\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tonError(error);\n\t\t\t}\n\t\t};\n\n\t\tinitializePlayer();\n\n\t\treturn () => {\n\t\t\tconst hls = playerRef.current;\n\t\t\tif (hls) {\n\t\t\t\thls.destroy();\n\t\t\t}\n\t\t};\n\t}, [onError, onErrorEvent, onLevelSwitching]);\n\n\tconst handleVideoPlay = useCallback(() => {\n\t\tsetIsPlaying(true);\n\t\tvideoRef.current.play();\n\t}, []);\n\n\tconst handleVideoPause = useCallback(() => {\n\t\tsetIsPlaying(false);\n\t\tvideoRef.current.pause();\n\t}, []);\n\n\treturn (\n\t\t<div className=\"video-container\">\n\t\t\t<video\n\t\t\t\tclassName=\"hls-video\"\n\t\t\t\tref={videoRef}\n\t\t\t\tonClick={isPlaying ? handleVideoPause : handleVideoPlay}\n\t\t\t\tmuted={isPlaying}\n\t\t\t/>\n\t\t\t<div className=\"controls-container\">\n\t\t\t\t{isLoading ? (\n\t\t\t\t\t<div>Loading...</div>\n\t\t\t\t) : (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<ProgressBar videoRef={videoRef} />\n\t\t\t\t\t\t<SkipButtons videoRef={videoRef} />\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default VideoPlayer;"],"mappings":"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"},"metadata":{},"sourceType":"module"}